COUNTRY_DATASET <- get(paste0(COUNTRY,"_", DATASET))
years <- names(COUNTRY_DATASET[["edge_lists"]]) %>%
as.numeric() %>%
sort()
first_year <- min(years)
last_year  <- max(years)
# subsetting country crs data by year
for (i in first_year:last_year) {
COUNTRY_DATASET_i <- COUNTRY_DATASET[["edge_lists"]][[as.character(i)]]
COUNTRY_DATASET_i <- COUNTRY_DATASET_i %>%
mutate(Country = COUNTRY, Year = i, data = DATASET)
assign(paste0(COUNTRY,"_", DATASET,"_", i), COUNTRY_DATASET_i)
}
# appending to make 1 per country per dataset
assign(
paste0(COUNTRY, "_", DATASET, "_all_years"),
bind_rows(mget(paste0(COUNTRY, "_", DATASET, "_", first_year:last_year)))
)
# cleaning the environment
rm(list = paste0(COUNTRY, "_", DATASET, "_", first_year:last_year), COUNTRY_DATASET_i, COUNTRY_DATASET)
rm(list = paste0(COUNTRY,"_",DATASET))
}
}
final_data <- NULL
for (COUNTRY in country_list) {
for (DATASET in dataframe) {
temp_data <- get(paste0(COUNTRY, "_", DATASET, "_all_years"))
temp_data <- temp_data %>%
map_df(as.character)
final_data <- bind_rows(final_data, temp_data)
}
}
rm(list = setdiff(ls(), "final_data"))
test_data <- final_data %>%
filter(Country == "burundi",
data == "crs",
Year == "2005")
test_data_nodes <- test_data %>%
mutate(id = sender, orgtype = sender_orgtype) %>%
select(id, orgtype) %>%
bind_rows(
test_data %>%
mutate(id = receiver, orgtype = receiver_orgtype) %>%
select(id, orgtype)
) %>%
distinct(id, .keep_all = TRUE) %>%
mutate(label = id) %>%
select(id, label) # deselected orgtype for now
test_data_edges <- test_data %>%
mutate(source = sender, target = receiver, id = 1:length(test_data$sender), type = "arrow") %>%
select(id, source, target) # deselected type for now
any(duplicated(test_data_nodes$id))
View(test_data_edges)
any(duplicated(test_data_nodes$id))
any(duplicated(test_data_edges$id))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(purrr)
library(jsonlite)
burundi_crs <- readRDS("../data/Raw Data/bdi_result_crs.rds")
colombia_crs <- readRDS("../data/Raw Data/col_result_crs.rds")
burundi_mptf <- readRDS("../data/Raw Data/bdi_result_mptf_nogovsig.rds")
colombia_mptf <- readRDS("../data/Raw Data/col_result_mptf_nogovsig.rds")
dataframe <- c("crs", "mptf")
country_list <- c("burundi", "colombia")
for (DATASET in dataframe) {
for (COUNTRY in country_list) {
COUNTRY_DATASET <- get(paste0(COUNTRY,"_", DATASET))
years <- names(COUNTRY_DATASET[["edge_lists"]]) %>%
as.numeric() %>%
sort()
first_year <- min(years)
last_year  <- max(years)
# subsetting country crs data by year
for (i in first_year:last_year) {
COUNTRY_DATASET_i <- COUNTRY_DATASET[["edge_lists"]][[as.character(i)]]
COUNTRY_DATASET_i <- COUNTRY_DATASET_i %>%
mutate(Country = COUNTRY, Year = i, data = DATASET)
assign(paste0(COUNTRY,"_", DATASET,"_", i), COUNTRY_DATASET_i)
}
# appending to make 1 per country per dataset
assign(
paste0(COUNTRY, "_", DATASET, "_all_years"),
bind_rows(mget(paste0(COUNTRY, "_", DATASET, "_", first_year:last_year)))
)
# cleaning the environment
rm(list = paste0(COUNTRY, "_", DATASET, "_", first_year:last_year), COUNTRY_DATASET_i, COUNTRY_DATASET)
rm(list = paste0(COUNTRY,"_",DATASET))
}
}
final_data <- NULL
for (COUNTRY in country_list) {
for (DATASET in dataframe) {
temp_data <- get(paste0(COUNTRY, "_", DATASET, "_all_years"))
temp_data <- temp_data %>%
map_df(as.character)
final_data <- bind_rows(final_data, temp_data)
}
}
rm(list = setdiff(ls(), "final_data"))
test_data <- final_data %>%
filter(Country == "burundi",
data == "crs",
Year == "2005")
test_data_nodes <- test_data %>%
mutate(id = sender, orgtype = sender_orgtype) %>%
select(id, orgtype) %>%
bind_rows(
test_data %>%
mutate(id = receiver, orgtype = receiver_orgtype) %>%
select(id, orgtype)
) %>%
distinct(id, .keep_all = TRUE) %>%
mutate(label = id) %>%
select(id, label) # deselected orgtype for now
test_data_edges <- test_data %>%
mutate(source = sender, target = receiver, id = 1:length(test_data$sender), type = "arrow") %>%
select(id, source, target) # deselected type for now
write_json(test_data, pretty = TRUE, path = "../data/Processed Data/test_data.json")
write_json(test_data_nodes, pretty = TRUE, path = "../data/Processed Data/test_data_nodes.json")
write_json(test_data_edges, pretty = TRUE, path = "../data/Processed Data/test_data_edges.json")
knitr::opts_chunk$set(echo = TRUE)
any(duplicated(test_data_edges))
View(test_data_edges)
help("duplicated")
any(duplicated(test_data_edges$source, test_data_edges$target))
test_data_edges <- test_data_edges %>%
mutate(n_contracts = count(unique(source, target)))
test_data_edges <- test_data_edges %>%
group_by(source, target) %>%
mutate(n_contracts - n()) %>%
ungroup()
test_data_edges <- test_data_edges %>%
group_by(source, target) %>%
mutate(n_contracts = n()) %>%
ungroup()
test_data_edges <- test_data_edges %>%
group_by(source, target) %>%
mutate(n_contracts = n()) %>%
ungroup()
test_data_edges <- test_data_edges %>%
group_by(source, target) %>%
mutate(n_contracts = nrow()) %>%
ungroup()
library(tidyverse)
library(purrr)
library(jsonlite)
test_data_edges <- test_data_edges %>%
group_by(source, target) %>%
mutate(n_contracts = n()) %>%
ungroup()
test_data_edges <- test_data_edges %>%
mutate(n_contracts = count(unique(source, target)))
View(test_data_edges)
View(test_data_edges)
help("distinct")
test_data_edges <- test_data_edges %>%
group_by(source, target) %>%
mutate(n_contracts = n()) %>%
ungroup() %>%
distinct(source, target)
View(test_data_edges)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(purrr)
library(jsonlite)
burundi_crs <- readRDS("../data/Raw Data/bdi_result_crs.rds")
colombia_crs <- readRDS("../data/Raw Data/col_result_crs.rds")
burundi_mptf <- readRDS("../data/Raw Data/bdi_result_mptf_nogovsig.rds")
colombia_mptf <- readRDS("../data/Raw Data/col_result_mptf_nogovsig.rds")
dataframe <- c("crs", "mptf")
country_list <- c("burundi", "colombia")
for (DATASET in dataframe) {
for (COUNTRY in country_list) {
COUNTRY_DATASET <- get(paste0(COUNTRY,"_", DATASET))
years <- names(COUNTRY_DATASET[["edge_lists"]]) %>%
as.numeric() %>%
sort()
first_year <- min(years)
last_year  <- max(years)
# subsetting country crs data by year
for (i in first_year:last_year) {
COUNTRY_DATASET_i <- COUNTRY_DATASET[["edge_lists"]][[as.character(i)]]
COUNTRY_DATASET_i <- COUNTRY_DATASET_i %>%
mutate(Country = COUNTRY, Year = i, data = DATASET)
assign(paste0(COUNTRY,"_", DATASET,"_", i), COUNTRY_DATASET_i)
}
# appending to make 1 per country per dataset
assign(
paste0(COUNTRY, "_", DATASET, "_all_years"),
bind_rows(mget(paste0(COUNTRY, "_", DATASET, "_", first_year:last_year)))
)
# cleaning the environment
rm(list = paste0(COUNTRY, "_", DATASET, "_", first_year:last_year), COUNTRY_DATASET_i, COUNTRY_DATASET)
rm(list = paste0(COUNTRY,"_",DATASET))
}
}
final_data <- NULL
for (COUNTRY in country_list) {
for (DATASET in dataframe) {
temp_data <- get(paste0(COUNTRY, "_", DATASET, "_all_years"))
temp_data <- temp_data %>%
map_df(as.character)
final_data <- bind_rows(final_data, temp_data)
}
}
rm(list = setdiff(ls(), "final_data"))
test_data <- final_data %>%
filter(Country == "burundi",
data == "crs",
Year == "2005")
test_data_nodes <- test_data %>%
mutate(id = sender, orgtype = sender_orgtype) %>%
select(id, orgtype) %>%
bind_rows(
test_data %>%
mutate(id = receiver, orgtype = receiver_orgtype) %>%
select(id, orgtype)
) %>%
distinct(id, .keep_all = TRUE) %>%
mutate(label = id) %>%
select(id, label) # deselected orgtype for now
test_data_edges <- test_data %>%
mutate(source = sender, target = receiver, id = 1:length(test_data$sender), type = "arrow") %>%
select(id, source, target) # deselected type for now
any(duplicated(test_data_nodes$id))
any(duplicated(test_data_edges$id))
any(duplicated(test_data_edges$source, test_data_edges$target))
test_data_edges1 <- test_data_edges %>%
group_by(source, target) %>%
mutate(n_contracts = n()) %>%
ungroup() %>%
distinct(source, target)
View(test_data_edges1)
help("slice")
test_data_edges1 <- test_data_edges %>%
group_by(source, target) %>%
mutate(n_contracts = n()) %>%
slice(1) %>%
ungroup()
View(test_data_edges1)
View(test_data_edges1)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(purrr)
library(jsonlite)
burundi_crs <- readRDS("../data/Raw Data/bdi_result_crs.rds")
colombia_crs <- readRDS("../data/Raw Data/col_result_crs.rds")
burundi_mptf <- readRDS("../data/Raw Data/bdi_result_mptf_nogovsig.rds")
colombia_mptf <- readRDS("../data/Raw Data/col_result_mptf_nogovsig.rds")
dataframe <- c("crs", "mptf")
country_list <- c("burundi", "colombia")
for (DATASET in dataframe) {
for (COUNTRY in country_list) {
COUNTRY_DATASET <- get(paste0(COUNTRY,"_", DATASET))
years <- names(COUNTRY_DATASET[["edge_lists"]]) %>%
as.numeric() %>%
sort()
first_year <- min(years)
last_year  <- max(years)
# subsetting country crs data by year
for (i in first_year:last_year) {
COUNTRY_DATASET_i <- COUNTRY_DATASET[["edge_lists"]][[as.character(i)]]
COUNTRY_DATASET_i <- COUNTRY_DATASET_i %>%
mutate(Country = COUNTRY, Year = i, data = DATASET)
assign(paste0(COUNTRY,"_", DATASET,"_", i), COUNTRY_DATASET_i)
}
# appending to make 1 per country per dataset
assign(
paste0(COUNTRY, "_", DATASET, "_all_years"),
bind_rows(mget(paste0(COUNTRY, "_", DATASET, "_", first_year:last_year)))
)
# cleaning the environment
rm(list = paste0(COUNTRY, "_", DATASET, "_", first_year:last_year), COUNTRY_DATASET_i, COUNTRY_DATASET)
rm(list = paste0(COUNTRY,"_",DATASET))
}
}
final_data <- NULL
for (COUNTRY in country_list) {
for (DATASET in dataframe) {
temp_data <- get(paste0(COUNTRY, "_", DATASET, "_all_years"))
temp_data <- temp_data %>%
map_df(as.character)
final_data <- bind_rows(final_data, temp_data)
}
}
rm(list = setdiff(ls(), "final_data"))
test_data <- final_data %>%
filter(Country == "burundi",
data == "crs",
Year == "2005")
test_data_nodes <- test_data %>%
mutate(id = sender, orgtype = sender_orgtype) %>%
select(id, orgtype) %>%
bind_rows(
test_data %>%
mutate(id = receiver, orgtype = receiver_orgtype) %>%
select(id, orgtype)
) %>%
distinct(id, .keep_all = TRUE) %>%
mutate(label = id) %>%
select(id, label) # deselected orgtype for now
test_data_edges <- test_data %>%
mutate(source = sender, target = receiver, id = 1:length(test_data$sender), type = "arrow") %>%
select(id, source, target) # deselected type for now
any(duplicated(test_data_nodes$id))
any(duplicated(test_data_edges$id))
any(duplicated(test_data_edges$source, test_data_edges$target))
test_data_edges <- test_data_edges %>%
group_by(source, target) %>%
mutate(n_contracts = n()) %>%
slice(1) %>%
ungroup()
write_json(test_data, pretty = TRUE, path = "../data/Processed Data/test_data.json")
write_json(test_data_nodes, pretty = TRUE, path = "../data/Processed Data/test_data_nodes.json")
write_json(test_data_edges, pretty = TRUE, path = "../data/Processed Data/test_data_edges.json")
View(test_data_edges)
library(shiny); runApp('Documents/American University/Networks of Influence and Support in Peace Operations/code/R Shiny app.R')
runApp('Documents/American University/Networks of Influence and Support in Peace Operations/code/R Shiny app.R')
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(purrr)
library(jsonlite)
burundi_crs <- readRDS("../data/Raw Data/bdi_result_crs.rds")
colombia_crs <- readRDS("../data/Raw Data/col_result_crs.rds")
burundi_mptf <- readRDS("../data/Raw Data/bdi_result_mptf_nogovsig.rds")
colombia_mptf <- readRDS("../data/Raw Data/col_result_mptf_nogovsig.rds")
dataframe <- c("crs", "mptf")
country_list <- c("burundi", "colombia")
for (DATASET in dataframe) {
for (COUNTRY in country_list) {
COUNTRY_DATASET <- get(paste0(COUNTRY,"_", DATASET))
years <- names(COUNTRY_DATASET[["edge_lists"]]) %>%
as.numeric() %>%
sort()
first_year <- min(years)
last_year  <- max(years)
# subsetting country crs data by year
for (i in first_year:last_year) {
COUNTRY_DATASET_i <- COUNTRY_DATASET[["edge_lists"]][[as.character(i)]]
COUNTRY_DATASET_i <- COUNTRY_DATASET_i %>%
mutate(Country = COUNTRY, Year = i, data = DATASET)
assign(paste0(COUNTRY,"_", DATASET,"_", i), COUNTRY_DATASET_i)
}
# appending to make 1 per country per dataset
assign(
paste0(COUNTRY, "_", DATASET, "_all_years"),
bind_rows(mget(paste0(COUNTRY, "_", DATASET, "_", first_year:last_year)))
)
# cleaning the environment
rm(list = paste0(COUNTRY, "_", DATASET, "_", first_year:last_year), COUNTRY_DATASET_i, COUNTRY_DATASET)
rm(list = paste0(COUNTRY,"_",DATASET))
}
}
final_data <- NULL
for (COUNTRY in country_list) {
for (DATASET in dataframe) {
temp_data <- get(paste0(COUNTRY, "_", DATASET, "_all_years"))
temp_data <- temp_data %>%
map_df(as.character)
final_data <- bind_rows(final_data, temp_data)
}
}
rm(list = setdiff(ls(), "final_data"))
test_data <- final_data %>%
filter(Country == "burundi",
data == "crs",
Year == "2005")
View(test_data)
glimpse(test_data)
test_nodes <- test_data %>%
mutate(id = sender, group = sender_orgtype) %>%
select(id, group) %>%
bind_rows(
test_data %>%
mutate(id = receiver, group = receiver_orgtype) %>%
select(id, group)
) %>%
distinct(id, .keep_all = TRUE) %>%
mutate(label = id)
View(test_nodes)
test_edges <- test_data %>%
mutate(from = sender, to = receiver) %>%
select(from, to)
View(test_edges)
help("group_by")
test_edges1 <- test_edges %>%
group_by(from, to) %>%
mutate(value = nrow())%>%
ungroup()
test_edges1 <- test_edges %>%
group_by(from, to) %>%
mutate(value = n())%>%
ungroup()
View(test_edges1)
test_edges1 <- test_edges %>%
group_by(from, to) %>%
mutate(value = n())%>%
ungroup() %>%
distinct(from, to, value, .keep_all = TRUE)
View(test_nodes)
View(test_edges1)
visNetwork(test_nodes, test_edges1)
library(visNetwork)
visNetwork(test_nodes, test_edges1)
View(test_nodes)
View(test_edges1)
visNetwork(test_nodes, test_edges1)%>%
visEdges(arrows = "to")
visNetwork(test_nodes, test_edges1) %>%
visLayout(randomSeed = 123) %>%
visEdges(arrows = "to")
visNetwork(test_nodes, test_edges1) %>%
visLayout(randomSeed = 123) %>%
visEdges(arrows = "to") %>%
visOptions(highlightNearest = TRUE, nodesIdSelection = TRUE)
help("visOptions")
visNetwork(test_nodes, test_edges1) %>%
visLayout(randomSeed = 123) %>%
visEdges(arrows = "to") %>%
visOptions(highlightNearest = TRUE)
visNetwork(test_nodes, test_edges1) %>%
visLayout(randomSeed = 123) %>%
visEdges(arrows = "to") %>%
visOptions(highlightNearest = TRUE, clickToUse = TRUE)
visNetwork(test_nodes, test_edges1) %>%
visLayout(randomSeed = 123) %>%
visEdges(arrows = "to") %>%
visOptions(highlightNearest = TRUE)
table(test_data$sector)
test_data <- test_data %>%
mutate(cost = as.numeric(cost),
n_contracts = as.numeric(n_contracts),
)
glimpse(test_data)
install.packages("openxlsx")
library(openxlsx)
write.xlsx(test_data, "../data/Processed Data/test_data.xlsx")
library(shiny); runApp('Documents/American University/Networks of Influence and Support in Peace Operations/code/R Shiny app.R')
runApp('Documents/American University/Networks of Influence and Support in Peace Operations/code/R Shiny app.R')
runApp('Documents/American University/Networks of Influence and Support in Peace Operations/code/R Shiny app.R')
runApp('Documents/American University/Networks of Influence and Support in Peace Operations/code/R Shiny app.R')
runApp('Documents/American University/Networks of Influence and Support in Peace Operations/code/R Shiny app.R')
runApp('Documents/American University/Networks of Influence and Support in Peace Operations/code/R Shiny app.R')
runApp('Documents/American University/Networks of Influence and Support in Peace Operations/code/R Shiny app.R')
runApp('Documents/American University/Networks of Influence and Support in Peace Operations/code/R Shiny app.R')
runApp('Documents/American University/Networks of Influence and Support in Peace Operations/code/R Shiny app.R')
saveRDS(test_data, "../data/Processed Data/test_data.rds")
master_data <- read_rds("../data/Processed Data/test_data.rds")
master_data <- readRDS("../data/Processed Data/test_data.rds")
pwd()
getwd()
getwd()
library(shiny); runApp('Documents/American University/Networks of Influence and Support in Peace Operations/code/R Shiny app.R')
runApp('Documents/American University/Networks of Influence and Support in Peace Operations/code/R Shiny app.R')
## Creating Edges Data Frame for the Visual
edges <- reactive({
master_data %>%
mutate(from = sender, to = receiver) %>%
select(from, to)
})
edges <-
master_data %>%
mutate(from = sender, to = receiver) %>%
select(from, to)
master_data <- readRDS("../data/Processed Data/test_data.rds")
git status
library(itscalledsoccer)
library(dplyr)
library(keyring)
library(httr2)
library(tidyverse)
library(jsonlite)
library(purrr)
library(lubridate)
# retrieving the environment
data <- AmericanSoccerAnalysis$new()
library(itscalledsoccer)
library(dplyr)
library(keyring)
library(httr2)
library(tidyverse)
library(jsonlite)
library(purrr)
library(lubridate)
# retrieving the environment
data <- AmericanSoccerAnalysis$new()
# retrieving data
players_data <- data$players
team_data <- data$teams
player_salary_data <- data $get_player_salaries()
player_goals_added_data <- data$get_player_goals_added()
player_xpass_data <- data$get_player_xpass()
player_xgoals_data <- data$get_player_xgoals()
player_xgoals_data <- data$get_player_xgoals()
library(shiny); runApp('Documents/DGT International/Projects/Player Performance App/code/Player_Performance_Lab.R')
install.packages('rsconnect')
runApp('Documents/DGT International/Projects/Player Performance App/code/Player_Performance_Lab.R')
library(shiny); runApp('Documents/DGT International/Projects/Player Performance App/code/Player_Performance_Lab.R')
pwd
getwd()
ls
setwd(/Users/dgt63/Documents/DGT International/Projects/Player Performance App)
setwd("/Users/dgt63/Documents/DGT International/Projects/Player Performance App")
getwd()
runApp('Player_Performance_Lab.R')
runApp('Player_Performance_Lab.R')
runApp('Player_Performance_Lab.R')
runApp('Player_Performance_Lab.R')
library(shiny); runApp('Player_Performance_Lab.R')
library(shiny); runApp('Player_Performance_Lab.R')
library(shiny); runApp('Player_Performance_Lab.R')
